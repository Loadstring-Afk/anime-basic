<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home - AniLab</title>
    <meta name="description" content="Watch anime online in HD. Subbed and dubbed anime streaming platform.">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/css/tailwind.output.css">
    <link rel="stylesheet" href="/css/glass.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        .hero-banner {
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), 
                        url('/assets/homeBanner.png') center/cover;
            min-height: 70vh;
        }
        
        .section-header {
            position: relative;
            padding-left: 1rem;
        }
        
        .section-header::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: linear-gradient(to bottom, #9333ea, #3b82f6);
            border-radius: 2px;
        }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <!-- Navigation (same as index.html) -->
    <nav class="navbar glass py-4 px-6 fixed w-full z-50">
        <div class="container mx-auto flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <a href="/" id="logo" class="text-3xl font-bold text-white hover:text-purple-300 transition">
                    <img src="/assets/logo.png" alt="AniLab" class="h-10 w-auto">
                </a>
                <div class="hidden md:flex space-x-6">
                    <a href="/home" class="text-white hover:text-purple-300 font-medium">Home</a>
                    <a href="/top-airing" class="text-gray-300 hover:text-white">Top Airing</a>
                    <a href="/most-popular" class="text-gray-300 hover:text-white">Popular</a>
                    <a href="/recently-added" class="text-gray-300 hover:text-white">New</a>
                    <a href="/movie" class="text-gray-300 hover:text-white">Movies</a>
                </div>
            </div>
            
            <div class="flex-1 max-w-xl mx-8">
                <div class="field">
                    <div class="control has-icons-left">
                        <input class="input glass-input pl-5 pr-10" 
                               type="text" 
                               placeholder="Search anime..."
                               id="searchInput">
                        <span class="icon is-left">
                            <i class="fas fa-search text-gray-400"></i>
                        </span>
                    </div>
                </div>
            </div>
            
            <div class="flex items-center space-x-4">
                <a href="/continue-watching" class="text-white hover:text-purple-300 relative" title="Continue Watching">
                    <i class="fas fa-history text-xl"></i>
                </a>
                <div class="dropdown is-right">
                    <div class="dropdown-trigger">
                        <button class="button is-purple is-rounded" aria-haspopup="true" aria-controls="user-menu">
                            <span class="icon"><i class="fas fa-user"></i></span>
                            <span>Account</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-20">
        <!-- Hero Spotlight -->
        <section id="spotlightSection" class="px-4 md:px-8 py-8">
            <div class="container mx-auto">
                <h2 class="section-header text-3xl font-bold mb-6">Spotlight</h2>
                <div class="spotlight-container">
                    <!-- Dynamically loaded -->
                </div>
            </div>
        </section>

        <!-- Continue Watching -->
        <section class="px-4 md:px-8 py-8">
            <div class="container mx-auto">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="section-header text-2xl font-bold">Continue Watching</h2>
                    <a href="/continue-watching" class="text-purple-400 hover:text-purple-300 text-sm font-medium">
                        View All <i class="fas fa-arrow-right ml-1"></i>
                    </a>
                </div>
                <div id="continueWatching" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                    <!-- Dynamic content -->
                </div>
            </div>
        </section>

        <!-- Trending Now -->
        <section class="px-4 md:px-8 py-8">
            <div class="container mx-auto">
                <h2 class="section-header text-2xl font-bold mb-6">Trending Now</h2>
                <div id="trendingSection" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                    <!-- Dynamic content -->
                </div>
            </div>
        </section>

        <!-- Recently Added -->
        <section class="px-4 md:px-8 py-8">
            <div class="container mx-auto">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="section-header text-2xl font-bold">Recently Added</h2>
                    <a href="/recently-added" class="text-purple-400 hover:text-purple-300 text-sm font-medium">
                        See More <i class="fas fa-arrow-right ml-1"></i>
                    </a>
                </div>
                <div id="recentSection" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                    <!-- Dynamic content -->
                </div>
            </div>
        </section>

        <!-- Popular Genres -->
        <section class="px-4 md:px-8 py-8">
            <div class="container mx-auto">
                <h2 class="section-header text-2xl font-bold mb-6">Browse Genres</h2>
                <div class="grid grid-cols-3 md:grid-cols-6 gap-4">
                    <a href="/genre/action" class="genre-card glass-card p-4 rounded-lg text-center hover:bg-purple-500/20 transition">
                        <i class="fas fa-fist-raised text-2xl mb-2 text-red-400"></i>
                        <span class="font-medium">Action</span>
                    </a>
                    <a href="/genre/adventure" class="genre-card glass-card p-4 rounded-lg text-center hover:bg-blue-500/20 transition">
                        <i class="fas fa-mountain text-2xl mb-2 text-blue-400"></i>
                        <span class="font-medium">Adventure</span>
                    </a>
                    <a href="/genre/comedy" class="genre-card glass-card p-4 rounded-lg text-center hover:bg-yellow-500/20 transition">
                        <i class="fas fa-laugh text-2xl mb-2 text-yellow-400"></i>
                        <span class="font-medium">Comedy</span>
                    </a>
                    <a href="/genre/drama" class="genre-card glass-card p-4 rounded-lg text-center hover:bg-pink-500/20 transition">
                        <i class="fas fa-theater-masks text-2xl mb-2 text-pink-400"></i>
                        <span class="font-medium">Drama</span>
                    </a>
                    <a href="/genre/fantasy" class="genre-card glass-card p-4 rounded-lg text-center hover:bg-purple-500/20 transition">
                        <i class="fas fa-dragon text-2xl mb-2 text-purple-400"></i>
                        <span class="font-medium">Fantasy</span>
                    </a>
                    <a href="/genre/romance" class="genre-card glass-card p-4 rounded-lg text-center hover:bg-red-500/20 transition">
                        <i class="fas fa-heart text-2xl mb-2 text-red-400"></i>
                        <span class="font-medium">Romance</span>
                    </a>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="glass mt-12 py-8 px-6">
        <div class="container mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <img src="/assets/logo.png" alt="AniLab" class="h-8 mb-4">
                    <p class="text-gray-400 text-sm">
                        Watch anime online in HD. Subbed and dubbed anime streaming platform.
                    </p>
                </div>
                <div>
                    <h3 class="font-bold mb-4">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="/home" class="text-gray-400 hover:text-white">Home</a></li>
                        <li><a href="/top-airing" class="text-gray-400 hover:text-white">Top Airing</a></li>
                        <li><a href="/recently-added" class="text-gray-400 hover:text-white">Recently Added</a></li>
                        <li><a href="/movie" class="text-gray-400 hover:text-white">Movies</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-bold mb-4">Legal</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white">Terms of Service</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">DMCA</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Contact</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-bold mb-4">Connect</h3>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white">
                            <i class="fab fa-discord text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white">
                            <i class="fab fa-twitter text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white">
                            <i class="fab fa-reddit text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white">
                            <i class="fab fa-github text-xl"></i>
                        </a>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-500 text-sm">
                <p>Â© 2024 AniLab. This site does not host any videos. All content is provided by third-party APIs.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
    <script src="/js/animations.js"></script>
    <script src="/js/continueWatching.js"></script>
    <script src="/js/lazyload.js"></script>
    
    <script>
        // Home page specific functionality
        document.addEventListener('DOMContentLoaded', async () => {
            // Load continue watching
            if (window.continueWatching) {
                window.continueWatching.renderToContainer('continueWatching');
            }
            
            // Load home data from API
            try {
                const response = await fetch('/api/home');
                const data = await response.json();
                
                if (data.success) {
                    // Render spotlight
                    if (data.data.spotlight && data.data.spotlight.length > 0) {
                        renderSpotlight(data.data.spotlight[0]);
                    }
                    
                    // Render trending
                    if (data.data.trending) {
                        renderAnimeSection(data.data.trending, 'trendingSection');
                    }
                    
                    // Render recent
                    if (data.data.recent) {
                        renderRecentSection(data.data.recent);
                    }
                }
            } catch (error) {
                console.log('Using fallback data');
                renderFallbackSections();
            }
            
            // Initialize animations
            initHomeAnimations();
        });
        
        function renderSpotlight(anime) {
            const container = document.querySelector('.spotlight-container');
            if (!container || !anime) return;
            
            container.innerHTML = `
                <div class="glass rounded-3xl overflow-hidden">
                    <div class="md:flex">
                        <div class="md:w-1/3 p-8">
                            <img src="${anime.poster || '/assets/placeholder.jpg'}" 
                                 alt="${anime.title}"
                                 class="w-full rounded-lg shadow-xl"
                                 onerror="this.src='/assets/placeholder.jpg'">
                        </div>
                        <div class="md:w-2/3 p-8">
                            <div class="flex items-center mb-4">
                                <span class="bg-purple-600 text-white px-3 py-1 rounded-full text-sm font-bold mr-4">
                                    #${anime.rank || 1} Spotlight
                                </span>
                                <span class="bg-gray-700 text-white px-3 py-1 rounded-full text-sm">
                                    ${anime.type || 'TV'}
                                </span>
                            </div>
                            <h1 class="text-4xl font-bold mb-4">${anime.title}</h1>
                            <h2 class="text-xl text-gray-300 mb-6">${anime.alternativeTitle || ''}</h2>
                            
                            <div class="flex flex-wrap gap-4 mb-6">
                                <div class="flex items-center">
                                    <i class="fas fa-clock text-gray-400 mr-2"></i>
                                    <span>${anime.duration || '24m'}</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-calendar text-gray-400 mr-2"></i>
                                    <span>${anime.aired || '2023'}</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-play-circle text-gray-400 mr-2"></i>
                                    <span>${anime.episodes?.eps || 12} Episodes</span>
                                </div>
                            </div>
                            
                            <p class="text-gray-300 mb-8 line-clamp-4">${anime.synopsis || 'No synopsis available.'}</p>
                            
                            <div class="flex space-x-4">
                                <a href="/watch/${anime.id}?ep=1" 
                                   class="button is-primary is-large font-bold">
                                    <i class="fas fa-play mr-2"></i>
                                    Watch Now
                                </a>
                                <a href="/anime/${anime.id}" 
                                   class="button is-light is-large">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    Details
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function renderAnimeSection(animeList, containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            container.innerHTML = animeList.map(anime => `
                <a href="/anime/${anime.id}" class="anime-card group">
                    <div class="relative overflow-hidden rounded-lg mb-3">
                        <img src="${anime.poster || '/assets/placeholder.jpg'}" 
                             alt="${anime.title}"
                             loading="lazy"
                             class="w-full h-64 object-cover transition-transform duration-300 group-hover:scale-105"
                             onerror="this.src='/assets/placeholder.jpg'">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent opacity-0 group-hover:opacity-100 transition-opacity">
                            <div class="absolute bottom-3 left-3 right-3">
                                <button class="w-full button is-small is-purple">
                                    <i class="fas fa-play mr-2"></i>
                                    Watch
                                </button>
                            </div>
                        </div>
                        <div class="absolute top-2 right-2">
                            <span class="tag is-dark">${anime.type || 'TV'}</span>
                        </div>
                    </div>
                    <h3 class="font-semibold truncate hover:text-purple-300 transition">${anime.title}</h3>
                    <div class="flex items-center text-sm text-gray-400">
                        <span class="mr-3"><i class="fas fa-star text-yellow-400"></i> ${anime.rating || 'N/A'}</span>
                        <span><i class="fas fa-clock"></i> ${anime.duration || '24m'}</span>
                    </div>
                </a>
            `).join('');
        }
        
        function initHomeAnimations() {
            // Animate genre cards on hover
            const genreCards = document.querySelectorAll('.genre-card');
            genreCards.forEach(card => {
                card.addEventListener('mouseenter', () => {
                    anime({
                        targets: card,
                        scale: 1.05,
                        duration: 300
                    });
                });
                card.addEventListener('mouseleave', () => {
                    anime({
                        targets: card,
                        scale: 1,
                        duration: 300
                    });
                });
            });
        }
    </script>
</body>
</html>